{% extends "layout/base-panel.html" %}
{% load static %}
{% load widget_tweaks %}

{% block head %}
    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
{% endblock head %}


{% block content %}
    <section class="max-w-4xl p-6 mx-auto bg-purple-500 rounded-md shadow-md dark:bg-gray-800 mt-5">
        <h1 class="text-2xl text-center font-bold text-white capitalize dark:text-white">Cadastro de Serviços</h1>
        {% if form.errors %}
            {% for error in form.errors %}
            <div class="bg-orange-100 border-l-4 border-orange-500 text-orange-700 p-4" role="alert">
                <p class="font-bold">Nem tudo é o que parece....</p>
                <p>{{error.sender}}</p>
              </div>            
            {% endfor %}
        {% endif %}
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            {{master_category}}
            <div class="grid grid-cols-1 gap-4 mt-4 sm:grid-cols-1">
                <div>
                    <label for="segment" class="block overflow-hidden bg-gray-100 rounded-md border border-gray-200 px-3 py-2 shadow-sm focus-within:border-blue-600 focus-within:ring-1 focus-within:ring-blue-600">
                        <span class="text-xs font-medium text-gray-700 "> Segmento </span>
                        <select name="segment" id="id_segment" class="block w-full px-4 py-2 mt-1 text-gray-800 bg-gray-100 dark:bg-gray-800 dark:text-gray-300 focus:outline-none" 
                            hx-get="{% url "panel:fetch_categories" %}" hx-target="#id_categories">
                            <option value="" selected>---------</option>
                            {% for cat in master_categories %}
                                <option value="{{cat.id}}" {% if master_category == cat.id %} selected {% endif %}>{{cat.name}}</option>
                            {% endfor %}
                        </select>    
                    </label>                    
                </div>
                {{category}}
                <div id='id_categories'>
                    {% include "service/partials/_select-categories.html" %}
                </div>               
                
                <div id='id_service'>
                    {% include "service/partials/_select-services.html" %}
                </div>               

                <div class='flex gap-4'>
                    <div class=''>
                        <label for="segment" class="block overflow-hidden bg-gray-100 rounded-md border border-gray-200 px-3 py-2 shadow-sm focus-within:border-blue-600 focus-within:ring-1 focus-within:ring-blue-600">
                            <span class="text-xs font-medium"> Preço (R$)</span>                        
                            {{form.price|append_attr:"class: block w-full px-4 py-2 mt-1 text-gray-700 bg-gray-100  dark:bg-gray-800 dark:text-gray-300 focus:outline-none" }} 
                        </label>
                    </div>
                    <div>
                        <label for="unit" class="block overflow-hidden bg-gray-100 rounded-md border border-gray-200 px-3 py-2 shadow-sm focus-within:border-blue-600 focus-within:ring-1 focus-within:ring-blue-600">
                            <span class="text-xs font-medium text-gray-700"> Unidade </span>                        
                            {{form.unit|append_attr:"class: block w-full px-4 py-2 mt-1 text-gray-700 bg-gray-100  dark:bg-gray-800 dark:text-gray-300 focus:outline-none" }} 
                        </label>
                    </div>
                    <div>
                        <label for="execution_time" class="block overflow-hidden bg-gray-100 rounded-md border border-gray-200 px-3 py-2 shadow-sm focus-within:border-blue-600 focus-within:ring-1 focus-within:ring-blue-600">
                            <span class="text-xs font-medium text-gray-700"> Tempo de Execução </span>                        
                            {{form.execution_time|append_attr:"class: block w-full px-4 py-2 mt-1 text-gray-700 bg-gray-100  dark:bg-gray-800 dark:text-gray-300 focus:outline-none" }} 
                        </label>
                    </div>
                </div>
                <div>
                    <label class="text-gray-100 dark:text-gray-200" for="passwordConfirmation">O que precisa para executar</label>
                    {{form.requirements|append_attr:"class: block w-full px-4 py-2 mt-1 text-gray-700 bg-gray-100 border border-gray-300 rounded-md dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 focus:border-blue-500 dark:focus:border-blue-500 focus:outline-none focus:ring" }} 
                </div>
                <div>
                    <label class="text-gray-100 dark:text-gray-200" for="passwordConfirmation">
                    {{form.active}}Ativo
                    </label>
                </div>                
                <div>
                    <label class="block text-sm font-medium text-white">Imagem</label>
                    <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md">
                        <div class="space-y-1 text-center">
                        <svg class="mx-auto h-12 w-12 text-white" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true">
                            <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        <div class="flex text-sm text-gray-600">
                            <label for="service_image" class="relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500">
                                <input id="service_image" name="service_image" type="file" class="sr-only">
                                <span class="">Carregue a imagem</span>
                            </label>
                            <p class="pl-1 text-white">ou arraste e solte aqui!</p>
                        </div>
                            <p class="text-xs text-white">
                                PNG, JPG, GIF até 2MB
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="flex justify-end mt-6">
                <button type="submit" class="px-6 py-2 leading-5 text-white transition-colors duration-200 transform bg-pink-500 rounded-md hover:bg-pink-700 focus:outline-none focus:bg-gray-600">Save</button>
            </div>
        </form>
    </section>      
{% endblock %}

{% block javascript %}
    <script src="{% static 'js/jquery.mask.min.js' %}"></script>
    <script>
        $(document).ready(function(){
            $('#id_execution_time').mask('00:00');
        });
    </script>
{% endblock javascript %}

